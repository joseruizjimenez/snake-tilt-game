<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Snake Tilt</title>
<style>
  body { margin:0; background:#000; display:flex; justify-content:center; align-items:center; height:100vh; }
  canvas { background:#111; }
</style>
</head>
<body>
<canvas id="game" width="400" height="400"></canvas>
<script>
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");

let grid=20;
let snake=[];
let snakeLength=5;
let apple={x:200,y:200};
let dx=0,dy=0;
let tilt={gamma:0,beta:0};

// --- Inicializar serpiente en línea horizontal ---
function initSnake(){
  snake=[];
  for(let i=0;i<snakeLength;i++){
    snake.push({x:100 - i*grid, y:100}); 
  }
}
initSnake();

// --- Eventos sensores ---
window.addEventListener("deviceorientation",e=>{
  tilt.gamma=e.gamma; // izquierda/derecha
  tilt.beta=e.beta;   // adelante/atrás
});

// --- Juego ---
function update(){
  // convertir inclinación en dirección
  if(Math.abs(tilt.gamma)>10){
    dx=tilt.gamma>0?grid:-grid;
    dy=0;
  }
  if(Math.abs(tilt.beta)>10){
    dy=tilt.beta>0?grid:-grid;
    dx=0;
  }

  let head={x:snake[0].x+dx,y:snake[0].y+dy};
  snake.unshift(head);
  while(snake.length>snakeLength) snake.pop();

  // colisión con bordes
  if(head.x<0||head.x>=canvas.width||head.y<0||head.y>=canvas.height){
    resetGame();
  }

  // colisión con cuerpo (ignorar cabeza = i=0)
  for(let i=1;i<snake.length;i++){
    if(snake[i].x===head.x && snake[i].y===head.y){
      resetGame();
    }
  }

  // comer manzana
  if(head.x===apple.x && head.y===apple.y){
    snakeLength++;
    apple.x=Math.floor(Math.random()*canvas.width/grid)*grid;
    apple.y=Math.floor(Math.random()*canvas.height/grid)*grid;
  }
}

function draw(){
  ctx.fillStyle="#111";
  ctx.fillRect(0,0,canvas.width,canvas.height);

  ctx.fillStyle="lime";
  snake.forEach((s,i)=>ctx.fillRect(s.x,s.y,grid-2,grid-2));

  ctx.fillStyle="red";
  ctx.fillRect(apple.x,apple.y,grid-2,grid-2);
}

function loop(){
  update();
  draw();
  setTimeout(loop,120);
}

function resetGame(){
  dx=dy=0;
  snakeLength=5;
  initSnake();
  apple={x:200,y:200};
}

loop();
</script>
</body>
</html>
